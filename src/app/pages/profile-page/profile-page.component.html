<cp-profile-component #profileComponent>

	<md-card class="background-card" *ngIf="profileComponent.account">
		<md-card-content>
			<md-card-title-group>
				<md-card-title>{{ profileComponent.account.givenName }}</md-card-title>
				<md-card-subtitle>
					<md-icon md-list-icon>mail_outline</md-icon> {{ profileComponent.account.email }}</md-card-subtitle>
				<md-card-subtitle>
					<md-icon md-list-icon>person_outline</md-icon> Joined {{ profileComponent.account.firstJoinedDate | date:'longDate'}}</md-card-subtitle>
			</md-card-title-group>
		</md-card-content>
	</md-card>

	<button md-fab (click)="openAddCloudProviderDialog(profileComponent)">
		<md-icon>add</md-icon>
	</button>

	<md-tab-group (selectedIndexChange)="profileComponent.addFormShowing=false" #configurationsTabGroup>

		<md-tab label="Cloud Providers">
			<md-card class="background-card" *ngIf="!profileComponent.cloudProviderParametersPresenters || profileComponent.cloudProviderParametersPresenters.length==0">
				No cloud providers registered yet
			</md-card>

			<md-card class="add-dialog-form" *ngIf="profileComponent.addFormShowing">
				<md-card-header>
					<md-card-title>
						<h2>Add cloud provider</h2>
					</md-card-title>
				</md-card-header>
				<md-card-content>
					<form [formGroup]="profileComponent.cloudProviderParametersForm" autocomplete="off">
						<md-input-container class="input-full-width"><input mdInput type="text" placeholder="Provider parameters name (required)" [formControl]="profileComponent.cloudProviderParametersForm.controls['name']"
							 autofocus>
						</md-input-container>
						<md-input-container class="input-full-width"><input mdInput type="text" placeholder="Cloud provider (required)" [formControl]="profileComponent.cloudProviderParametersForm.controls['cloudProvider']"
							 autofocus>
						</md-input-container>
						<h3>Parameters <button md-icon-button color="primary" (click)="profileComponent.addNewCloudProviderParametersFormField()">
              <md-icon>add</md-icon> 
            	</button></h3>
						<!--Fields-->
						<div *ngFor="let fieldFormGroup of profileComponent.cloudProviderParametersForm.controls['fields'].controls">
							<form [formGroup]="fieldFormGroup">
								<table style="width: 100%" cellspacing="0">
									<tr>
										<td>
											<md-input-container class="input-full-width"><input mdInput type="text" placeholder="Enter parameter key" [formControl]="fieldFormGroup.controls['key']" autofocus></md-input-container>
										</td>
										<td>
											<md-input-container class="input-full-width"><input mdInput type="text" placeholder="Enter parameter value" [formControl]="fieldFormGroup.controls['value']"
												 autofocus></md-input-container>
										</td>
									</tr>
								</table>
							</form>
						</div>

					</form>
				</md-card-content>
				<md-card-actions align="end">
					<button *ngIf="profileComponent.cloudProviderParametersForm.controls['cloudProvider'].hasError('required') || profileComponent.cloudProviderParametersForm.controls['name'].hasError('required')"
					 md-raised-button class="button-color-accent" disabled>
							SAVE</button>
					<button *ngIf="!profileComponent.cloudProviderParametersForm.controls['cloudProvider'].hasError('required') && !profileComponent.cloudProviderParametersForm.controls['name'].hasError('required')"
					 md-raised-button class="button-color-accent" (click)="profileComponent.addCloudProviderParameters(profileComponent.cloudProviderParametersForm.value); profileComponent.addFormShowing = false">
							SAVE</button>
				</md-card-actions>
			</md-card>

			<div class="md-content" *ngIf="profileComponent.cloudProviderParametersPresenters">
				<span class="credentials-card-container">
						<md-card [routerLink]=" ['/cloudprovider/', cloudProviderParametersPresenter.name]"  *ngFor="let cloudProviderParametersPresenter of profileComponent.cloudProviderParametersPresenters" class="credentials-container">
							<md-toolbar class="summary-card-toolbar">
								<md-icon class="card-type-icon">vpn_key</md-icon><h3>{{ cloudProviderParametersPresenter.name }}</h3>
								<span class="fill-remaining-space"></span>
				<!--<button md-icon-button (click)="profileComponent.shareCloudProviderParametersDialogShowing=!profileComponent.shareCloudProviderParametersDialogShowing">
									<md-icon>share</md-icon> 
								</button>
								<button md-icon-button color="warn" (click)="profileComponent.removeCloudProviderParameters(cloudProviderParametersPresenter)">
									<md-icon>delete_forever</md-icon> 
								</button>-->
				</md-toolbar>
				<md-card-content>
					<span class="share-credentials-dialog" *ngIf="profileComponent.shareCloudProviderParametersDialogShowing">
						<form #shareProviderForm>
							<md-input-container class="input-full-width"><input mdInput
							type="email" placeholder="Share email (required)" 
							[(ngModel)]="userEmail" name="userEmail" autofocus>
							</md-input-container>
						</form>
						<button md-raised-button (click)="profileComponent.shareCloudProviderParameters(cloudProviderParametersPresenter, userEmail); profileComponent.shareCloudProviderParametersDialogShowing = false">
							SHARE</button>
					</span>
					<md-list dense>
						<md-list-item>
							<h3 md-line>Provider</h3>
							<p md-line class="param-value">{{ cloudProviderParametersPresenter.cloudProvider }}</p>
						</md-list-item>
					</md-list>
				</md-card-content>
				<md-card-actions>
					<!--<button md-raised-button (click)="profileComponent.setCurrentlySelectedCloudProviderParameters(cloudProviderParametersPresenter)">
									SELECT
								</button>-->
				</md-card-actions>
				</md-card>

				<md-card [routerLink]=" ['/cloudprovider/shared/', cloudProviderParametersPresenter.name]" *ngFor="let cloudProviderParametersPresenter of profileComponent.sharedCloudProviderParametersPresenters"
				 class="credentials-container">
					<md-toolbar class="summary-card-toolbar">
						<md-icon class="card-type-icon">vpn_key</md-icon>
						<h3>{{ cloudProviderParametersPresenter.name }}</h3>
						<span class="fill-remaining-space"></span>
						<p>SHARED</p>
					</md-toolbar>
					<md-card-content>
						<md-list dense>
							<span class="flex-container-wide">
										<md-list-item>
											<h3 md-line>Provider</h3>
											<p md-line class="param-value">{{ cloudProviderParametersPresenter.cloudProvider }}</p>
										</md-list-item>
										<span class="fill-remaining-space"></span>
							<md-list-item>
								<h3 md-line>Owner</h3>
								<p md-line class="param-value">{{ cloudProviderParametersPresenter.accountEmail }}</p>
							</md-list-item>
							</span>
						</md-list>
					</md-card-content>
					<md-card-actions>
						<!--<button md-raised-button (click)="profileComponent.setCurrentlySelectedCloudProviderParameters(cloudProviderParametersPresenter)">
									SELECT
								</button>-->
					</md-card-actions>
				</md-card>
				<!--Get all the sahred credentials from each team the user is a member of??-->
				<span *ngFor="let teamPresenter of profileComponent.teamPresenters">
							
						</span>
				</span>
			</div>
		</md-tab>

		<md-tab label="Configurations">

			<md-card class="add-dialog-form" *ngIf="profileComponent.addFormShowing">
				<md-card-header>
					<md-card-title>
						<h2>Add configuration</h2>
					</md-card-title>
				</md-card-header>
				<md-card-content>
					<form [formGroup]="profileComponent.configurationForm" autocomplete="off">
						<md-input-container class="input-full-width"><input mdInput type="text" placeholder="Configuration name (required)" [formControl]="profileComponent.configurationForm.controls['name']"
							 autofocus>
						</md-input-container>
						<md-input-container class="input-full-width"><input mdInput type="text" placeholder="Cloud provider parameters name (required)" [formControl]="profileComponent.configurationForm.controls['cloudProviderParametersName']"
							 autofocus>
						</md-input-container>
						<md-input-container class="input-full-width"><input mdInput type="text" placeholder="SSH public key" [formControl]="profileComponent.configurationForm.controls['sshKey']"
							 autofocus>
						</md-input-container>
						<md-input-container class="input-full-width"><input mdInput type="text" 
							placeholder="Deployment Parameters Name (required)" 
							[formControl]="profileComponent.configurationForm.controls['deploymentParametersName']" 
							autofocus>
						</md-input-container>
					</form>
				</md-card-content>
				<md-card-actions align="end">
					<button *ngIf="profileComponent.configurationForm.controls['name'].hasError('required') || profileComponent.configurationForm.controls['cloudProviderParametersName'].hasError('required')"
					 md-raised-button class="button-color-accent" disabled>
					SAVE</button>
					<button *ngIf="!profileComponent.configurationForm.controls['name'].hasError('required') && !profileComponent.configurationForm.controls['cloudProviderParametersName'].hasError('required')"
					 md-raised-button class="button-color-accent" (click)="profileComponent.addConfiguration(profileComponent.configurationForm.value); profileComponent.addFormShowing = false">
					SAVE</button>
				</md-card-actions>
			</md-card>

			<md-card class="background-card" *ngIf="!profileComponent.configurationPresenters || profileComponent.configurationPresenters.length==0">
				No configurations registered yet
			</md-card>

			<div class="md-content" *ngIf="profileComponent.configurationPresenters">
				<div class="credentials-card-container">
					<md-card *ngFor="let configurationPresenter of profileComponent.configurationPresenters" class="credentials-container">
						<md-toolbar class="summary-card-toolbar">
							<!--<md-icon class="card-type-icon">settings_applications</md-icon>-->
							<h3>{{ configurationPresenter.name }}</h3>
							<span class="fill-remaining-space"></span>
							<button md-icon-button color="warn" (click)="profileComponent.removeConfiguration(configurationPresenter)">
								<md-icon>delete_forever</md-icon> 
							</button>
						</md-toolbar>
						<md-card-content>
							<md-list dense>
								<md-list-item>
									<md-icon md-list-icon class="card-type-icon">vpn_key</md-icon>
									<h3 md-line>Cloud provider parameters</h3>
									<p md-line class="param-value">{{ configurationPresenter.cloudProviderParametersName }}</p>
								</md-list-item>
								<md-list-item>
									<md-icon md-list-icon class="card-type-icon">lock_open</md-icon>
									<h3 md-line>SSH Public Key</h3>
									<p md-line class="param-value">{{ configurationPresenter.sshKey }}</p>
								</md-list-item>
								<md-list-item>
									<md-icon md-list-icon class="card-type-icon">settings_applications</md-icon>
									<h3 md-line>Parameters</h3>
									<p md-line class="param-value">{{ configurationPresenter.deploymentParametersName }}</p>
								</md-list-item>
							</md-list>
						</md-card-content>
					</md-card>
				</div>
			</div>

		</md-tab>

		<md-tab label="Deployment Parameters">

			<md-card class="add-dialog-form" *ngIf="profileComponent.addFormShowing">
				<md-card-header>
					<md-card-title><h2>Add Deployment Parameters</h2></md-card-title>
				</md-card-header>
				<md-card-content>
					<form [formGroup]="profileComponent.deploymentParametersForm" autocomplete="off">
						<md-input-container class="input-full-width">
							<input mdInput 
							type="text" 
							placeholder="Deployment Parameters Name (required)" 
							[formControl]="profileComponent.deploymentParametersForm.controls['name']" 
							autofocus>
						</md-input-container>
						
						<h3>Parameters <button md-icon-button color="primary" (click)="profileComponent.addNewDeploymentParametersFormField()">
						<md-icon>add</md-icon> 
						</button></h3>
						<!--Fields-->
						<div *ngFor="let fieldFormGroup of profileComponent.deploymentParametersForm.controls['fields'].controls">
							<form [formGroup]="fieldFormGroup">
								<table style="width: 100%" cellspacing="0"><tr>
								<td><md-input-container class="input-full-width"><input mdInput 
									type="text" 
									placeholder="Enter parameter key" 
									[formControl]="fieldFormGroup.controls['key']" 
									autofocus></md-input-container></td>
								<td><md-input-container class="input-full-width"><input mdInput 
									type="text" 
									placeholder="Enter parameter value" 
									[formControl]="fieldFormGroup.controls['value']" 
									autofocus></md-input-container></td>
								</tr></table>
							</form>
						</div>
					</form>
				</md-card-content>
				<md-card-actions align="end">
					<button *ngIf="profileComponent.deploymentParametersForm.controls['name'].hasError('required')"
					md-raised-button class="button-color-accent" disabled>
					SAVE</button>
					<button *ngIf="!profileComponent.deploymentParametersForm.controls['name'].hasError('required')"
					md-raised-button class="button-color-accent" 
					(click)="profileComponent.addDeploymentParameters(profileComponent.deploymentParametersForm.value); profileComponent.addFormShowing = false">
					SAVE</button>
				</md-card-actions>
			</md-card>

			<md-card class="background-card" *ngIf="!profileComponent.deploymentParametersPresenters || profileComponent.deploymentParametersPresenters.length==0">
				No deployment parameters registered yet
			</md-card>

			<div class="md-content" *ngIf="profileComponent.deploymentParametersPresenters">
				<div class="credentials-card-container">
					<md-card *ngFor="let deploymentParameterPresenter of profileComponent.deploymentParametersPresenters" class="credentials-container">
						<md-toolbar class="summary-card-toolbar">
							<md-icon class="card-type-icon">settings_applications</md-icon><h3>{{ deploymentParameterPresenter.name }}</h3>
							<span class="fill-remaining-space"></span>
							<button md-icon-button color="warn" (click)="profileComponent.removeDeploymentParameters(deploymentParameterPresenter)">
								<md-icon>delete_forever</md-icon> 
							</button>
						</md-toolbar>
						<md-card-content>
							<md-list dense>
								<md-list-item *ngFor="let deploymentParameterField of deploymentParameterPresenter.fields">
									<h3 md-line>{{ deploymentParameterField.key }}</h3>
									<p md-line class="param-value">{{ deploymentParameterField.value }}</p>
								</md-list-item>
							</md-list>
						</md-card-content>
					</md-card>
				</div>
			</div>

		</md-tab>

		<md-tab label="Teams">

			<md-card class="add-dialog-form" *ngIf="profileComponent.addFormShowing">
				<md-card-header>
					<md-card-title>
						<h2>Add team</h2>
					</md-card-title>
				</md-card-header>
				<md-card-content>
					<form [formGroup]="profileComponent.teamForm" autocomplete="off">
						<md-input-container class="input-full-width">
							<input mdInput type="text" placeholder="Team name (required)" [formControl]="profileComponent.teamForm.controls['name']"
							 autofocus>
						</md-input-container>
					</form>
				</md-card-content>
				<md-card-actions align="end">
					<button *ngIf="profileComponent.teamForm.controls['name'].hasError('required')" md-raised-button class="button-color-accent"
					 disabled>
							SAVE</button>
					<button *ngIf="!profileComponent.teamForm.controls['name'].hasError('required')" md-raised-button class="button-color-accent"
					 (click)="profileComponent.addTeam(profileComponent.teamForm.value); profileComponent.addFormShowing = false">
							SAVE</button>
				</md-card-actions>
			</md-card>

			<md-card class="background-card" *ngIf="!profileComponent.teamPresenters || profileComponent.teamPresenters.length==0">
				No teams associated with this account
			</md-card>

			<div class="md-content" *ngIf="profileComponent.teamPresenters">
				<span class="credentials-card-container">
						<md-card [routerLink]=" ['/team/', teamPresenter.name]"  *ngFor="let teamPresenter of profileComponent.teamPresenters" class="credentials-container">
							<md-toolbar class="summary-card-toolbar">
								<md-icon class="card-type-icon">group</md-icon><h3>{{ teamPresenter.name }}</h3>
								<span class="fill-remaining-space"></span>
				<p *ngIf="teamPresenter.isOwner">OWNER</p>
				<!--<button md-icon-button (click)="profileComponent.shareCloudProviderParametersDialogShowing=!profileComponent.shareCloudProviderParametersDialogShowing">
									<md-icon>share</md-icon> 
								</button>
								<button md-icon-button color="warn" (click)="profileComponent.removeCloudProviderParameters(cloudProviderParametersPresenter)">
									<md-icon>delete_forever</md-icon> 
								</button>-->
				</md-toolbar>
				<md-card-content>
					<span class="share-credentials-dialog" *ngIf="profileComponent.addMemberToTeamDialogShowing">
									<form #shareProviderForm>
										<md-input-container class="input-full-width">
											<input mdInput
										type="email" placeholder="Share email (required)" 
										[(ngModel)]="memberAccountEmail" name="memberAccountEmail" autofocus>
										</md-input-container>
									</form>
									<!--<span class="fill-remaining-space"></span>-->
					<button md-raised-button (click)="profileComponent.addTeamMember(teamPresenter, memberAccountEmail); profileComponent.addMemberToTeamDialogShowing = false">
									ADD</button>
					</span>
				</md-card-content>
				<md-card-actions>
				</md-card-actions>
				</md-card>
				</span>
			</div>

		</md-tab>

	</md-tab-group>

</cp-profile-component>