<!--Add setup button-->
<button *ngIf="volumesTabGroup.selectedIndex == 1" md-fab (click)="addVolumeSetupFormShowing=!addVolumeSetupFormShowing">
	<md-icon>add</md-icon>
</button>

<md-tab-group #volumesTabGroup>
	<md-tab>
		<template md-tab-label>Instances</template>
		<template md-tab-content>
			<md-content *ngIf="volumeInstanceDeployments">
				<md-card *ngIf="volumeInstanceDeployments.length==0">No volume deployments for user {{ credentialService.getUsername() }} yet</md-card>

				<div class="card-container">
					<md-card *ngFor="let volumeInstanceDeployment of volumeInstanceDeployments">
						<md-card-title-group>
							<md-card-title>
								<md-icon>done</md-icon> {{ volumeInstanceDeployment.name }}
							</md-card-title>
							<md-card-subtitle>{{ volumeInstanceDeployment.reference }}</md-card-subtitle>
						</md-card-title-group>

						<md-card-content>
							<md-list dense>
								<md-list-item>
									<h3 md-line>ID</h3>
									<p md-line>{{ volumeInstanceDeployment.providerId }}</p>
								</md-list-item>
							</md-list>
						</md-card-content>

						<md-progress-bar *ngIf="volumeInstanceDeployment.destroying" mode="indeterminate"></md-progress-bar>
						<md-card-actions align="end" *ngIf="!volumeInstanceDeployment.destroying">
							<button md-icon-button color="warn" (click)="destroyVolume(volumeInstanceDeployment)">
								<md-icon>delete_forever</md-icon>
						  </button>
						</md-card-actions>
					</md-card>
				</div>
			</md-content>
		</template>
	</md-tab>

	<md-tab>
		<template md-tab-label>Setups</template>
		<template md-tab-content>
			<!--Add setup form-->
			<md-card *ngIf="addVolumeSetupFormShowing">
				<md-card-title>Add volume setup</md-card-title>
				<md-card-content>
					<form [formGroup]="volumeSetupForm" autocomplete="off">
						<md-input type="url" placeholder="Repository URI" [formControl]="volumeSetupForm.controls['repoUri']" autofocus>
						</md-input>
						<div *ngIf="!volumeSetupForm.controls['repoUri'].valid" class="ui error message">URI is invalid</div>
						<div *ngIf="volumeSetupForm.controls['repoUri'].hasError('required')" class="ui error message">URI is required</div>
					</form>
				</md-card-content>
				<md-card-actions>
					<button md-raised-button color="accent" (click)="addVolumeSetup(volumeSetupForm.value); addVolumeSetupFormShowing = false"
						align="end">Add</button>
				</md-card-actions>
			</md-card>

			<!--List setups-->
			<md-card *ngIf="volumeDeployers.length==0">No volume setups for user {{ credentialService.getUsername() }} yet</md-card>
			<div class="card-container">
				<md-content *ngIf="volumeDeployers">
					<div class="card-container">
						<md-card *ngFor="let volumeDeployer of volumeDeployers">
							<md-card-title-group>
								<md-card-title>
									<md-icon>settings_application</md-icon> {{ volumeDeployer.name }}
								</md-card-title>
								<md-card-subtitle><a href="{{ volumeDeployer.repoUri }}">{{ volumeDeployer.repoUri }}</a></md-card-subtitle>
							</md-card-title-group>

							<md-card-content>
								<md-list dense>
									
								</md-list>
							</md-card-content>

							<md-progress-bar *ngIf="volumeDeployer.deploying || volumeDeployer.removing" mode="indeterminate"></md-progress-bar>
							<md-card-actions align="end" *ngIf="!volumeDeployer.deploying && !volumeDeployer.removing ">
								<!--<md-input type="text" [(ngModel)]="volumeDeployer.name" name="reference" class="form-control" readonly hidden></md-input>
								<md-input type="text" [(ngModel)]="volumeDeployer.repoUri" name="reference" class="form-control" readonly hidden></md-input>-->
								<button md-icon-button color="accent" (click)="deployVolume(volumeDeployer)">
									<md-icon>cloud_upload</md-icon>
								</button>
								<button md-icon-button color="warn" (click)="removeVolumeSetup(volumeDeployer)">
									<md-icon>clear</md-icon>
								</button>
							</md-card-actions>
						</md-card>
					</div>
				</md-content>
			</div>

		</template>
	</md-tab>
</md-tab-group>